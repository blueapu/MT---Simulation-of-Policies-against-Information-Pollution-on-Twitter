---
title: "MT Code Result Analysis 02"
author: "Markus Rottmann"
date: "2021 04 16"
output:
  html_document:
      toc: true
      toc_depth: 5
---

****

&nbsp;

#### Description

This Code is to analyze/build the results from the simulating each countermeasure (in NetLogo).
<br>
The settings for the simulation runs are:

  + 2 initial Information Pollution Tweets
  + 3 days of Tweet life-span
  + 365 days of simulation
  
  
**Input**

  + `network_sim_warn_01_00_noip2_lstwt3_365_01.csv`
  + `network_sim_delay_01_00_noip2_lstwt3_365_01.csv`
  + `network_sim_ban_01_00_noip2_lstwt3_365_01.csv`
  
  
**Output**

  + `[YYY - to insert]`



****

&nbsp;

```{r setup, include=FALSE}

## clearing memory
rm(list=ls(all=T))

## loading (and installing) packages
# defining required packages
req_packages <- c("dplyr", "knitr", "kableExtra", "rvest", "igraph",
"ggplot2", "tibble", "quanteda", "stargazer", "tidyr", "stringr", "lme4",
"rtweet", "lubridate", "MASS", "dplyr")

# checking, if already installed
new_packages <- req_packages[!(req_packages %in% installed.packages()[,"Package"])]

# installing (downloading) missing packages
if(length(new_packages) > 0) {
  install.packages(new_packages)
} 

# loading required packages
lapply(req_packages, library, character.only = TRUE) 

# deleting auxillary variables
rm(req_packages, new_packages)

## setting global options
options(repos = "https://cran.rstudio.com")
options(stringsAsFactors = FALSE)
knitr::opts_chunk$set(echo = TRUE, fig.width = 7, fig.height = 5)

# frequenty needed packages: ("dplyr", "knitr", "kableExtra", "rvest", "igraph",
# "pageviews", "WikipediR", "ggplot2", "tibble", "quanteda", "stargazer", "tidyr",
# "stringr", "lme4", "rtweet", "lubridate")

```

&nbsp;

***

#### 1. Contermeasure "Warning"

4 x 30 Runs are performed. Settings for these simulation runs are:

  + Run 1: 0% lowering of probability to post an IP Tweet.
  + Run 2: 25% lowering of probability to post an IP Tweet.
  + Run 3: 50% lowering of probability to post an IP Tweet.
  + Run 4: 75% lowering of probability to post an IP Tweet.

```{r 01 countermeasure_warning, include = TRUE, results = TRUE, eval = TRUE, message = FALSE, warning = FALSE}


## loading data
data01 <- read.csv2("./RawData/network_sim_warn_01_00_noip2_lstwt3_365_01.csv") %>% 
    as.data.frame(.) %>% 
    `colnames<-`(c("p_warn", "sum_newip"))

## getting descriptive statistics on base model (strength = 0)
desc01 <- data01 %>% 
          filter(., p_warn == 0) %>% 
          dplyr::select(., sum_newip)
summary(desc01)
desc01 %>% 
  pull(.) %>% 
  sd(.)

## performing OLS
res01 <- data01 %>% 
  lm(data = ., formula = sum_newip ~ p_warn)

## viewing OLS and saving as .html-table
# viewing results
summary(res01)
# saving results
res01 %>% 
   stargazer(.,
     style = "apsr",
     digits = 2,
     type = "html",
     out = "./PlotsTables/regres_warn_noip2_lstwt3_365_01.html")

## creating scatter plot and saving
# creating
plt_warn01 <- data01 %>% 
            ggplot(.) +
            geom_point(aes(x = p_warn, y = sum_newip))
# plotting
plt_warn01

# saving
plt_warn01 %>% 
        ggsave(., filename = "./PlotsTables/plt_warn01.png",
               units = "cm",
               dpi = "retina",
               height = 8,
               width = 14)

## removing auxillary variables
rm(list= ls(pattern= "data"))
rm(list= ls(pattern= "res"))
rm(list= ls(pattern= "plt"))
rm(list= ls(pattern= "desc"))



```


&nbsp;

***

#### 2. Contermeasure "Delay"

3 x 30 Runs are performed. Settings for these simulation runs are:

  + Run 1: No delay (0 days).
  + Run 2: 1 day delay.
  + Run 3: 2 days delay.


```{r 02 countermeasure_delay, include = TRUE, results = TRUE, eval = TRUE, message = FALSE, warning = FALSE}

## loading data
data02 <- read.csv2("./RawData/network_sim_delay_01_00_noip2_lstwt3_365_01.csv") %>% 
    as.data.frame(.) %>% 
    `colnames<-`(c("d_delay", "sum_newip"))

## getting descriptive statistics on base model (strength = 0)
desc02 <- data02 %>% 
          filter(., d_delay == 0) %>% 
          dplyr::select(., sum_newip)
summary(desc02)
desc02 %>% 
  pull(.) %>% 
  sd(.)

## performing OLS
# over entire countermeasure strength
res02 <- data02 %>% 
  lm(data = ., formula = sum_newip ~ d_delay)
# over 0 days to 1 day
res02_0t1 <- data02 %>% 
   dplyr::filter(., d_delay <= 1) %>% 
   lm(data = ., formula = sum_newip ~ d_delay)
# over 1 days to 2 days
res02_1t2 <- data02 %>% 
   dplyr::filter(., d_delay >= 1) %>% 
   lm(data = ., formula = sum_newip ~ d_delay)

## viewing OLS and saving as .html-table
# over entire strength variation
summary(res02)
# over 0 days to 1 day
summary(res02_0t1)
# over 1 day to 2 days
summary(res02_0t1)

## viewing OLS and saving as .html-table
# viewing results
summary(res02)
# saving results
res02 %>% 
    stargazer(.,
      style = "apsr",
      digits = 2,
      type = "html",
      out = "./PlotsTables/regres_delay_noip2_lstwt3_365_01.html")

## creating scatter plot and saving
# creating
plt_delay01 <- data02 %>% 
            ggplot(.) +
            geom_point(aes(x = d_delay, y = sum_newip))
# plotting
plt_delay01

# saving
plt_delay01 %>% 
        ggsave(., filename = "./PlotsTables/plt_delay01.png",
               units = "cm",
               dpi = "retina",
               height = 8,
               width = 14)

## removing auxillary variables
rm(list= ls(pattern= "data"))
rm(list= ls(pattern= "res"))
rm(list= ls(pattern= "plt"))
rm(list= ls(pattern= "desc"))


```


&nbsp;

***

#### 3. Contermeasure "Account Ban"

4 x 30 Runs are performed. Settings for these simulation runs are:

  + Run 1: 0 account bans 
  + Run 2: 91 bans (every 4th day)
  + Run 3: 183 account bans (every 2nd day)
  + Run 4: 273 account bans (every 1.5th day)
  

```{r 03 countermeasure_ban, include = TRUE, results = TRUE, eval = TRUE, message = FALSE, warning = FALSE}


## loading data
data03 <- read.csv2("./RawData/network_sim_ban_01_00_noip2_lstwt3_365_01.csv") %>% 
    as.data.frame(.) %>% 
    `colnames<-`(c("no_ban", "sum_newip",
                   "d_sim", "rem_acc"))

## getting descriptive statistics on base model (strength = 0)
desc03 <- data03 %>% 
          filter(., no_ban == 0) %>% 
          dplyr::select(., sum_newip)
summary(desc03)
desc03 %>% 
  pull(.) %>% 
  sd(.)

## performing OLS 
res03 <- data03 %>% 
   lm(data = ., formula = sum_newip ~ no_ban)

## over entire strength variation
summary(res03)

## saving results
res03 %>% 
   stargazer(.,
        style = "apsr",
        digits = 2,
        type = "html",
        out = "./PlotsTables/regres_ban_noip2_lstwt3_365_01.html")

## creating scatter plot and saving
# creating
plt_ban01 <- data03 %>% 
              ggplot(.) +
              geom_point(aes(x = no_ban, y = sum_newip))
# plotting
plt_ban01

# saving
plt_ban01 %>% 
        ggsave(., filename = "./PlotsTables/plt_ban01.png",
               units = "cm",
               dpi = "retina",
               height = 8,
               width = 14)

## removing auxillary variables
rm(list= ls(pattern= "data"))
rm(list= ls(pattern= "res"))
rm(list= ls(pattern= "plt"))
rm(list= ls(pattern= "desc"))

## Repository ----------------------------------------------------------------------------
# p2 <- p1 +
#       geom_text(aes(x = 13, y = 1025, 
#              label = "Ende Shutdown: 11. Mai"), 
#              lineheight = 1.2,
#              hjust = 0,
#              vjust = 0,
#              colour = "black", 
#              family="Helvetica", 
#              size = 5.5) +
# 
#      geom_curve(aes(x = 17, y = 990, xend = 18.8,  yend = 950), 
#              colour = "black", 
#              size = 0.5, 
#              curvature = 0.3,
#              arrow = arrow(length = unit(0.03, "npc"))) 
# 
# ## Anzeigen und Speichern
# p2
# ggsave(p2, filename = "./TablesFigures/stackedbar_tweets.png", dpi = "retina",
#        height = 8, width = 14)




```



